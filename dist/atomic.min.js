var atomic=function(){"use strict";function isUndefined(value){return value===undefined}function isNull(value){return value===null}function isObject(value){return value===Object(value)}function isArray(value){return Array.isArray(value)}function isDate(value){return value instanceof Date}function isBlob(value){return value&&typeof value.size==="number"&&typeof value.type==="string"&&typeof value.slice==="function"}function isFile(value){return isBlob(value)&&(typeof value.lastModifiedDate==="object"||typeof value.lastModified==="number")&&typeof value.name==="string"}function isFormData(value){return value instanceof FormData}function objectToFormData(obj,cfg,fd,pre){if(isFormData(cfg)){pre=fd;fd=cfg;cfg=null}cfg=cfg||{};cfg.indices=cfg.indices||false;fd=fd||new FormData;if(isUndefined(obj)){return fd}else if(isNull(obj)){fd.append(pre,"")}else if(isArray(obj)){if(!obj.length){var key=pre+"[]";fd.append(key,"")}else{obj.forEach(function(value,index){var key=pre+"["+(cfg.indices?index:"")+"]";objectToFormData(value,cfg,fd,key)})}}else if(isDate(obj)){fd.append(pre,obj.toISOString())}else if(isObject(obj)&&!isFile(obj)&&!isBlob(obj)){Object.keys(obj).forEach(function(prop){var value=obj[prop];if(isArray(value)){while(prop.length>2&&prop.lastIndexOf("[]")===prop.length-2){prop=prop.substring(0,prop.length-2)}}var key=pre?pre+"["+prop+"]":prop;objectToFormData(value,cfg,fd,key)})}else{fd.append(pre,obj)}return fd}function Atomic(url,options){if(!supports())throw"Atomic: This browser does not support the methods used in this plugin.";settings=extend(Atomic.defaults,options||{});return makeRequest(url)}Atomic.defaults={method:"GET",username:null,password:null,data:{},headers:{"Content-type":"application/x-www-form-urlencoded"},responseType:"text",timeout:null,withCredentials:false};Atomic.get=function(url,data,settings){return new Atomic(url,extend({data:data},settings))};Atomic.post=function(url,data,settings){return new Atomic(url,extend({data:data,method:"POST"},settings))};var settings;var supports=function(){return"XMLHttpRequest"in window&&"JSON"in window&&"Promise"in window};var extend=function(){var extended={};var merge=function(obj){for(var prop in obj){if(obj.hasOwnProperty(prop)){if(Object.prototype.toString.call(obj[prop])==="[object Object]"){extended[prop]=extend(extended[prop],obj[prop])}else{extended[prop]=obj[prop]}}}};for(var i=0;i<arguments.length;i++){var obj=arguments[i];merge(obj)}return extended};var parse=function(req){var result;if(settings.responseType!=="text"&&settings.responseType!==""){return{data:req.response,xhr:req}}try{result=JSON.parse(req.responseText)}catch(e){result=req.responseText}return{data:result,xhr:req}};var param=function(obj){if(/application\/json/i.test(settings.headers["Content-type"])||Object.prototype.toString.call(obj)==="[object Array]")return JSON.stringify(obj);return objectToFormData(obj,{indices:true})};var makeRequest=function(url){var request=new XMLHttpRequest;var xhrPromise=new Promise(function(resolve,reject){request.onreadystatechange=function(){if(request.readyState!==4)return;if(request.status>=200&&request.status<300){resolve(parse(request))}else{reject({status:request.status,statusText:request.statusText})}};request.open(settings.method,url,true,settings.username,settings.password);request.responseType=settings.responseType;for(var header in settings.headers){if(settings.headers.hasOwnProperty(header)){request.setRequestHeader(header,settings.headers[header])}}if(settings.timeout){request.timeout=settings.timeout;request.ontimeout=function(e){reject({status:408,statusText:"Request timeout"})}}if(settings.withCredentials){request.withCredentials=true}request.send(param(settings.data))});xhrPromise.cancel=function(){request.abort()};return xhrPromise};return Atomic}();